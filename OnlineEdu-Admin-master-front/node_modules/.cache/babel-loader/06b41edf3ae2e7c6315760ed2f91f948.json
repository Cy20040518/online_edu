{"remainingRequest":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\babel-loader\\lib\\index.js!C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\src\\views\\edu_course\\educourse_tmp_watch.vue?vue&type=script&lang=js","dependencies":[{"path":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\src\\views\\edu_course\\educourse_tmp_watch.vue","mtime":1646101641000},{"path":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\babel.config.js","mtime":1646101641000},{"path":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\babel-loader\\lib\\index.js","mtime":456789000000},{"path":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Users\\86193\\Desktop\\OnlineEdu-Admin-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkM6L1VzZXJzLzg2MTkzL0Rlc2t0b3AvT25saW5lRWR1LUFkbWluLW1hc3Rlci9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7Ci8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCi8vCgppbXBvcnQgeyBsaXN0Q2hhcHRlcnNUbXAgYXMgbGlzdENoYXB0ZXJzIH0gZnJvbSAnQC9hcGkvY2hhcHRlcic7CmltcG9ydCB7IGxpc3RWaWRlb3NUbXAgYXMgbGlzdFZpZGVvcywgZ2V0UGxheUF1dGggfSBmcm9tICdAL2FwaS92aWRlbyc7CmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnRWR1Y291cnNlV2F0Y2gnLAogIGRhdGE6IGZ1bmN0aW9uIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBjb3Vyc2VJZDogbnVsbCwKICAgICAgcGxheWVyOiBudWxsLAogICAgICBjaGFwdGVyRGF0YTogW10sCiAgICAgIC8vIDxjaGFwdGVySWQsIHZpZGVvTGlzdD4KICAgICAgdmlkZW9EYXRhOiB7fSwKICAgICAgcmVmcmVzaEtleTogZmFsc2UsCiAgICAgIGFjdGl2ZUl0ZW06ICcnCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgc2V0RGF0YTogZnVuY3Rpb24gc2V0RGF0YShjb3Vyc2VJZCkgewogICAgICB0aGlzLmNvdXJzZUlkID0gY291cnNlSWQ7CiAgICAgIHRoaXMubGlzdENoYXB0ZXJzQW5kVmlkZW9zKGNvdXJzZUlkKTsKICAgIH0sCiAgICBsaXN0Q2hhcHRlcnNBbmRWaWRlb3M6IGZ1bmN0aW9uIGxpc3RDaGFwdGVyc0FuZFZpZGVvcyhjb3Vyc2VJZCkgewogICAgICB2YXIgX3RoaXMgPSB0aGlzOwogICAgICBsaXN0Q2hhcHRlcnMoY291cnNlSWQpLnRoZW4oZnVuY3Rpb24gKHJlc3ApIHsKICAgICAgICBfdGhpcy5jaGFwdGVyRGF0YSA9IHJlc3AuZGF0YTsKICAgICAgICB2YXIgbGVuID0gcmVzcC5kYXRhLmxlbmd0aDsKICAgICAgICB2YXIgX2l0ZXJhdG9yID0gX2NyZWF0ZUZvck9mSXRlcmF0b3JIZWxwZXIocmVzcC5kYXRhKSwKICAgICAgICAgIF9zdGVwOwogICAgICAgIHRyeSB7CiAgICAgICAgICB2YXIgX2xvb3AgPSBmdW5jdGlvbiBfbG9vcCgpIHsKICAgICAgICAgICAgdmFyIGMgPSBfc3RlcC52YWx1ZTsKICAgICAgICAgICAgbGlzdFZpZGVvcyhjLmlkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAgICAgX3RoaXMudmlkZW9EYXRhW2MuaWRdID0gcmVzcC5kYXRhOwogICAgICAgICAgICAgIC8vIOiOt+WPluWujOinhumikeWIl+ihqAogICAgICAgICAgICAgIGlmICgtLWxlbiA8PSAwKSB7CiAgICAgICAgICAgICAgICAvLyDlhbPplK7vvJrlvLrliLbliLfmlrDnu4Tku7bmuLLmn5MKICAgICAgICAgICAgICAgIF90aGlzLnJlZnJlc2hLZXkgPSAhX3RoaXMucmVmcmVzaEtleTsKICAgICAgICAgICAgICAgIC8vIOWHhuWkh+esrOS4gOS4quinhumikQogICAgICAgICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgICAgICAgdmFyIGZpcnN0Q2hhcHRlcklkID0gX3RoaXMuY2hhcHRlckRhdGFbMF0uaWQ7CiAgICAgICAgICAgICAgICAgIHZhciBmaXJzdFZpZGVvID0gX3RoaXMudmlkZW9EYXRhW2ZpcnN0Q2hhcHRlcklkXVswXTsKICAgICAgICAgICAgICAgICAgX3RoaXMucGxheShmaXJzdFZpZGVvLnZpZGVvSWQpOwogICAgICAgICAgICAgICAgICAvLyDorr7nva7nrKzkuIDkuKrop4bpopHmv4DmtLsKICAgICAgICAgICAgICAgICAgX3RoaXMuYWN0aXZlSXRlbSA9ICIiLmNvbmNhdChmaXJzdENoYXB0ZXJJZCwgIjoiKS5jb25jYXQoZmlyc3RWaWRlby5pZCk7CiAgICAgICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwogICAgICAgICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgICAgICAgX2xvb3AoKTsKICAgICAgICAgIH0KICAgICAgICB9IGNhdGNoIChlcnIpIHsKICAgICAgICAgIF9pdGVyYXRvci5lKGVycik7CiAgICAgICAgfSBmaW5hbGx5IHsKICAgICAgICAgIF9pdGVyYXRvci5mKCk7CiAgICAgICAgfQogICAgICB9KTsKICAgIH0sCiAgICBwbGF5OiBmdW5jdGlvbiBwbGF5KHZpZGVvU291cmNlSWQpIHsKICAgICAgdmFyIF90aGlzMiA9IHRoaXM7CiAgICAgIGlmICh0aGlzLnBsYXllcikgewogICAgICAgIC8vIGNvbnN0IGF1dG9QbGF5ID0gdGhpcy5wbGF5ZXIuZ2V0U3RhdHVzKCkgPT09ICdwbGF5aW5nJwogICAgICAgIC8vIOmUgOavgeaSreaUvuWZqAogICAgICAgIHRoaXMucGxheWVyLmRpc3Bvc2UoKTsKICAgICAgICB0aGlzLnBsYXllciA9IG51bGw7CiAgICAgICAgZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ0pfcHJpc21QbGF5ZXInKS5pbm5lckhUTUwgPSAnJzsKICAgICAgICBnZXRQbGF5QXV0aCh2aWRlb1NvdXJjZUlkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgIF90aGlzMi5wbGF5ZXIgPSBuZXcgQWxpcGxheWVyKHsKICAgICAgICAgICAgaWQ6ICdKX3ByaXNtUGxheWVyJywKICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLAogICAgICAgICAgICB3aWR0aDogJzEwMCUnLAogICAgICAgICAgICBoZWlnaHQ6ICcxMDAlJywKICAgICAgICAgICAgdmlkOiB2aWRlb1NvdXJjZUlkLAogICAgICAgICAgICBwbGF5YXV0aDogcmVzcC5kYXRhCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBnZXRQbGF5QXV0aCh2aWRlb1NvdXJjZUlkKS50aGVuKGZ1bmN0aW9uIChyZXNwKSB7CiAgICAgICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW5kZWYKICAgICAgICAgIF90aGlzMi5wbGF5ZXIgPSBuZXcgQWxpcGxheWVyKHsKICAgICAgICAgICAgaWQ6ICdKX3ByaXNtUGxheWVyJywKICAgICAgICAgICAgYXV0b3BsYXk6IGZhbHNlLAogICAgICAgICAgICB3aWR0aDogJzEwMCUnLAogICAgICAgICAgICBoZWlnaHQ6ICcxMDAlJywKICAgICAgICAgICAgdmlkOiB2aWRlb1NvdXJjZUlkLAogICAgICAgICAgICBwbGF5YXV0aDogcmVzcC5kYXRhCiAgICAgICAgICB9KTsKICAgICAgICB9KTsKICAgICAgfQogICAgfSwKICAgIGRpc3Bvc2U6IGZ1bmN0aW9uIGRpc3Bvc2UoKSB7CiAgICAgIGlmICh0aGlzLnBsYXllcikgewogICAgICAgIHRoaXMucGxheWVyLmRpc3Bvc2UoKTsKICAgICAgICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnSl9wcmlzbVBsYXllcicpLmlubmVySFRNTCA9ICcnOwogICAgICB9CiAgICB9CiAgfQp9Ow=="},{"version":3,"names":["listChaptersTmp","listChapters","listVideosTmp","listVideos","getPlayAuth","name","data","courseId","player","chapterData","videoData","refreshKey","activeItem","methods","setData","listChaptersAndVideos","_this","then","resp","len","length","_iterator","_createForOfIteratorHelper","_step","_loop","c","value","id","firstChapterId","firstVideo","play","videoId","concat","e","console","log","s","n","done","err","f","videoSourceId","_this2","dispose","document","getElementById","innerHTML","Aliplayer","autoplay","width","height","vid","playauth"],"sources":["src/views/edu_course/educourse_tmp_watch.vue"],"sourcesContent":["<template>\n  <el-row style=\"position: relative\" class=\"course\">\n    <el-col :span=\"17\" style=\"position: relative\">\n      <div style=\"padding-top: 70%\" />\n      <div style=\"position: absolute;top: 0;left: 0;width: 100%;height: 100%;\">\n        <div id=\"J_prismPlayer\" />\n      </div>\n    </el-col>\n    <el-col :key=\"refreshKey\" :span=\"7\" class=\"selection\">\n      <div v-for=\"chapter of chapterData\" :key=\"chapter.id\" class=\"chapter\">\n        <div class=\"title ellipsis\" :title=\"chapter.title\">{{ chapter.title }}</div>\n        <div\n          v-for=\"(value) of videoData[chapter.id]\"\n          :key=\"`${chapter.id}:${value.id}`\"\n          :class=\"{'video':true,'active':activeItem===`${chapter.id}:${value.id}`}\"\n          @click=\"play(value.videoId);activeItem=`${chapter.id}:${value.id}`;\"\n        >\n          <div class=\"title ellipsis\" :title=\"value.title\">\n            <i v-if=\"value.oid>0\" class=\"el-icon-video-play\" />\n            <el-badge v-else is-dot>\n              <i class=\"el-icon-video-play\" />\n            </el-badge>\n            {{ value.title }}\n          </div>\n          <div class=\"info\">\n            <span class=\"duration\">时长: {{ value.duration }}</span>\n            <span v-if=\"value.free\" class=\"free\">免费</span>\n          </div>\n        </div>\n      </div>\n    </el-col>\n  </el-row>\n</template>\n\n<script>\nimport { listChaptersTmp as listChapters } from '@/api/chapter'\nimport { listVideosTmp as listVideos, getPlayAuth } from '@/api/video'\n\nexport default {\n  name: 'EducourseWatch',\n  data() {\n    return {\n      courseId: null,\n      player: null,\n      chapterData: [],\n      // <chapterId, videoList>\n      videoData: {},\n      refreshKey: false,\n      activeItem: ''\n    }\n  },\n  methods: {\n    setData(courseId) {\n      this.courseId = courseId\n      this.listChaptersAndVideos(courseId)\n    },\n    listChaptersAndVideos(courseId) {\n      listChapters(courseId).then(resp => {\n        this.chapterData = resp.data\n        let len = resp.data.length\n        for (const c of resp.data) {\n          listVideos(c.id).then(resp => {\n            this.videoData[c.id] = resp.data\n            // 获取完视频列表\n            if (--len <= 0) {\n              // 关键：强制刷新组件渲染\n              this.refreshKey = !this.refreshKey\n              // 准备第一个视频\n              try {\n                const firstChapterId = this.chapterData[0].id\n                const firstVideo = this.videoData[firstChapterId][0]\n                this.play(firstVideo.videoId)\n                // 设置第一个视频激活\n                this.activeItem = `${firstChapterId}:${firstVideo.id}`\n              } catch (e) {\n                console.log(e)\n              }\n            }\n          })\n        }\n      })\n    },\n    play(videoSourceId) {\n      if (this.player) {\n        // const autoPlay = this.player.getStatus() === 'playing'\n        // 销毁播放器\n        this.player.dispose()\n        this.player = null\n        document.getElementById('J_prismPlayer').innerHTML = ''\n        getPlayAuth(videoSourceId).then(resp => {\n          // eslint-disable-next-line no-undef\n          this.player = new Aliplayer({\n            id: 'J_prismPlayer',\n            autoplay: false,\n            width: '100%',\n            height: '100%',\n            vid: videoSourceId,\n            playauth: resp.data\n          })\n        })\n      } else {\n        getPlayAuth(videoSourceId).then(resp => {\n          // eslint-disable-next-line no-undef\n          this.player = new Aliplayer({\n            id: 'J_prismPlayer',\n            autoplay: false,\n            width: '100%',\n            height: '100%',\n            vid: videoSourceId,\n            playauth: resp.data\n          })\n        })\n      }\n    },\n    dispose() {\n      if (this.player) {\n        this.player.dispose()\n        document.getElementById('J_prismPlayer').innerHTML = ''\n      }\n    }\n  }\n}\n</script>\n\n<style scoped lang=\"scss\">\n\n.course {\n  .selection {\n    position: absolute;\n    right: 0;\n    height: 100%;\n    padding: 20px 16px;\n    overflow: auto;\n    background-color: #232323;\n    &::-webkit-scrollbar {\n      width: 4px;\n    }\n    &::-webkit-scrollbar-thumb {\n      background: #64a5ff;\n    }\n    &::-webkit-scrollbar-track {\n      background: #232323;\n    }\n  }\n}\n\n.chapter {\n  color: #c7c7c7;\n  margin-top: 16px;\n\n  > .title {\n    font-size: 16px;\n  }\n\n  .video {\n    font-size: 14px;\n    margin-top: 16px;\n    cursor: pointer;\n\n    i {\n      margin-right: 6px;\n    }\n\n    &:hover,&.active {\n      color: #20a0ff;\n\n      .duration {\n        color: #20a0ff;\n      }\n    }\n\n    .info {\n      font-size: 12px;\n      margin: 5px 0 0 20px;\n      color: #777777;\n\n      span {\n        margin-right: 12px;\n\n        &:last-child {\n          margin-right: 0;\n        }\n      }\n\n      .free {\n        color: #ff4f23;\n      }\n    }\n  }\n}\n</style>\n"],"mappings":"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","ignoreList":[]}]}